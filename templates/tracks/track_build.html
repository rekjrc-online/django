{% extends "base.html" %}
{% block content %}
  <h2 style="text-align:center;">
    {% if form.instance.pk %}Edit Track{% else %}Create Track{% endif %}
  </h2>

  <!-- Profile summary -->
  <div class="card" style="max-width: 600px; margin: 20px auto; padding: 15px; text-align: left;">
    <center>
      {% if profile.avatar %}
        <a target="_blank" href="{{ profile.avatar.url }}">
          <img src="{{ profile.avatar.url }}" alt="Avatar"
               style="width:100px; height:100px; border-radius:50%; object-fit:cover;">
        </a>
      {% else %}
        <img src="/static/nophoto_TRACK.png" alt="Avatar"
             style="width:100px; height:100px; border-radius:50%; object-fit:cover;">
      {% endif %}
    </center>

    <h3 style="margin-bottom: 5px;">Profile: {{ profile.displayname }}</h3>
    {% if profile.bio %}
      <p style="color: #555; font-size: 14px;">{{ profile.bio }}</p>
    {% endif %}
    {% if profile.website %}
      <p style="color: #555; font-size: 14px;">
        <a href="{{ profile.website }}" target="_blank">{{ profile.website }}</a>
      </p>
    {% endif %}
  </div>

  <!-- Track form -->
  <div class="card" style="max-width: 600px; margin: 20px auto; padding: 15px;">
    <form method="post" style="text-align:left;">
      {% csrf_token %}
      {{ form.as_p }}

      <h3>Track Attributes</h3>
      {{ attribute_formset.management_form }}
      {% for f in attribute_formset %}
        <div style="border:1px solid #ddd; padding:10px; margin-bottom:10px; border-radius:5px;">
          {{ f.as_p }}
          {% if f.instance.pk %}
            <label>Delete: {{ f.DELETE }}</label>
          {% endif %}
        </div>
      {% endfor %}

      <button type="submit"
              style="width:100%; padding:10px; background-color:#1da1f2; color:white; border:none; border-radius:5px; cursor:pointer;">
        Save
      </button>
    </form>
  </div>
{% endblock %}
