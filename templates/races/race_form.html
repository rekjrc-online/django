{% extends "base.html" %}

{% block content %}
  <h2 style="text-align:center;">
    {% if object %}Edit{% else %}Create{% endif %} Race
  </h2>

  <!-- Profile summary section -->
  <div class="card" style="max-width: 600px; margin: 20px auto; padding: 15px; text-align: left;">
    <center>
      {% if form.instance.profile.avatar %}
        <a target="_blank" href="{{ form.instance.profile.avatar.url }}">
          <img src="{{ form.instance.profile.avatar.url }}" alt="Avatar" class="avatar"
               style="width:100px; height:100px; border-radius:50%; object-fit:cover;">
        </a>
      {% else %}
        <img src="/static/nophoto_LOCATION.png" alt="Avatar" class="avatar"
             style="width:100px; height:100px; border-radius:50%; object-fit:cover;">
      {% endif %}
    </center>

    <h3 style="margin-bottom: 5px;">Profile: {{ form.instance.profile.displayname }}</h3>

    {% if form.instance.profile.bio %}
        <p style="color: #555; font-size: 14px; margin-top: 0;">{{ form.instance.profile.bio }}</p>
    {% endif %}

    {% if form.instance.profile.location %}
        <p style="color: #555; font-size: 14px; margin-top: 0;">{{ form.instance.profile.location }}</p>
    {% endif %}

    {% if form.instance.profile.website %}
        <p style="color: #555; font-size: 14px; margin-top: 0;">
          <a href="{{ form.instance.profile.website }}" target="_blank">{{ form.instance.profile.website }}</a>
        </p>
    {% endif %}
  </div>

  <!-- Race form section -->
  <div class="card" style="max-width: 600px; margin: 20px auto; padding: 15px; text-align: center;">
    <form method="post" style="text-align: left;">
      {% csrf_token %}
      {{ form.as_p }}

      <h2>Attributes</h2>
      {{ attributes.management_form }}
      {% for formset_form in attributes %}
        <div style="margin-bottom: 10px;">
          {{ formset_form.as_p }}
          {% if formset_form.instance.pk %}
            <input type="checkbox" name="{{ formset_form.prefix }}-DELETE" id="{{ formset_form.prefix }}-DELETE">
            <label for="{{ formset_form.prefix }}-DELETE">Delete</label>
          {% endif %}
        </div>
      {% endfor %}

      <button type="submit"
          style="width: 100%; padding: 10px; background-color:#1da1f2; color:white; border:none; border-radius:5px; cursor:pointer;">
        Save
      </button>
    </form>
  </div>

  <div style="text-align: center; margin-bottom: 20px;">
    <a href="{% url 'races:race_list' %}">Cancel</a>
  </div>
{% endblock %}
